package controllers

import (
	"testing"

	"k8s.io/kops/pkg/pki"

	cmapi "github.com/jetstack/cert-manager/pkg/apis/certmanager/v1"
)

func Test_SignCSR(t *testing.T) {
	csr := &cmapi.CertificateRequest{
		Spec: cmapi.CertificateRequestSpec{
			Request: []byte("LS0tLS1CRUdJTiBDRVJUSUZJQ0FURSBSRVFVRVNULS0tLS0KTUlJQzZEQ0NBZEFDQVFBd0x6RVVNQklHQTFVRUNoTUxhMjl3Y3k1ck9ITXVhVzh4RnpBVkJnTlZCQU1URG0xbApkSEpwWTNNdGMyVnlkbVZ5TUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUF4YUt2CktadWQ3K3FpSDJEd2Y0TDlGLzJkOHNqNUdsWDNHME1ranhEcXVIWjJqblBHVHNjenFDYkk1VkJLdEtlcytzakwKaDVXV3BzWUlSa2U3dy9zeEtveC9wa1BuUjRsZEJZQnJ5NTF2aGc5NElqRlFtb01YeTUxTjBsbHk1ZEhOOVQ4OApRTzV3dEN5VE83QTNibjhTMjNGRGtsUzhWNk5UNTZiUzVXbTc2akd1a3prUVZ4VDdCTkpicFMwU1AyTnFyT0FMClVjYWVsR3ducHhzODBRemFpQk9PRzB2disyNVd2ZW5jYy9yeUQxMkVXUFBxZFJTRHg0ZUJVanBUYjd3WStJZnkKajZGVGlxZXZsVllLSk9qMmhYSHRZMCtTWitnK0tEQW82SEFwbGd3Zml6WHZCekhRT3g5aVZvWGdsYTBWa1JBNQpwazI1R3YvWHEzUVE1UWw2ZndJREFRQUJvSFF3Y2dZSktvWklodmNOQVFrT01XVXdZekExQmdOVkhSRUVMakFzCmdnNXRaWFJ5YVdOekxYTmxjblpsY29JYWJXVjBjbWxqY3kxelpYSjJaWEl1YTNWaVpTMXplWE4wWlcwd0N3WUQKVlIwUEJBUURBZ0FBTUIwR0ExVWRKUVFXTUJRR0NDc0dBUVVGQndNQkJnZ3JCZ0VGQlFjREFqQU5CZ2txaGtpRwo5dzBCQVFzRkFBT0NBUUVBRnphUlR3V3NUTkV0eTYwdDRsK0lxNkpvWDN0K2ZCVW4vUVFFcVlwRC9WYnY2ejR6CmdXODBhNENnNlFIUU12MWRIUTdsNGFFbjRnenZEcWtheUdCRmM4ZjBhdTFxVTFYZVl4QTFsS0trcGo3eUlwVjUKd3ExWVNXRmhVRzdmclRHakQzaHVQczEwbm9CWVI0ZSthVWdUOFVHUEc2NDlJU1o4RlhWelZrYVNCdDFoR2VFbwpSTGk1Nm41UE9RSEIvd0wyR091YWp0c0lpcGs1YWNLMmlIdHhDdWJQaUlLdjZVWEVkZ05mTXV2NUxUbXI1YXFLCkNWQ3RlN1kxaTk3eWpRVURqeWgyMmxDa2lYcWlrMjRKN3ptSzlzM1BlSjRXNDRPM1laMjVLWHFUNlBHcEFoL20KZUExL1QyL0hBWG9VN091MExTVFkzTURzQWVkUzBCbmdxZ0o2aWc9PQotLS0tLUVORCBDRVJUSUZJQ0FURSBSRVFVRVNULS0tLS0K"),
		},
	}

	keystore, _ := pki.NewMockKeystore()

	err := signCSR(csr, keystore)
	if err != nil {
		t.Fatalf("could not sign CSR: %v", err)
	}
}
